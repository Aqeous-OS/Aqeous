\hypertarget{mouse_8c}{}\section{Experimental Edition/\+Source/\+Drivers/mouse/mouse.c File Reference}
\label{mouse_8c}\index{Experimental Edition/\+Source/\+Drivers/mouse/mouse.\+c@{Experimental Edition/\+Source/\+Drivers/mouse/mouse.\+c}}
{\ttfamily \#include $<$graphics.\+c$>$}\\*
{\ttfamily \#include $<$common.\+h$>$}\\*
{\ttfamily \#include $<$sys.\+h$>$}\\*
{\ttfamily \#include $<$interrupts.\+h$>$}\\*
Include dependency graph for mouse.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8c__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{mouse_8c__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\+\_\+wait} (unsigned char type)
\item 
void \hyperlink{mouse_8c_ae4379d8fb20df85b51a1f087ff736307}{mouse\+\_\+write} (unsigned char a\+\_\+write)
\item 
unsigned char \hyperlink{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c}{mouse\+\_\+read} ()
\item 
void \hyperlink{mouse_8c_a6ca7c8595f4c1116a2e057ad74fe27a5}{mouse\+\_\+handler} ()
\item 
void \hyperlink{mouse_8c_a2c765935a206229e0b5d7c53d85326f0}{mouseinit} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{mouse_8c_aa3d2105adcc19a5aba525c805fc49ff2}{mousex} =100
\item 
int \hyperlink{mouse_8c_a6d4a0453f23b7c4df1a7be2972529a0b}{mousey} =100
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{mouse.\+c@{mouse.\+c}!mouse\+\_\+handler@{mouse\+\_\+handler}}
\index{mouse\+\_\+handler@{mouse\+\_\+handler}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mouse\+\_\+handler()}{mouse_handler()}}]{\setlength{\rightskip}{0pt plus 5cm}void mouse\+\_\+handler (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mouse_8c_a6ca7c8595f4c1116a2e057ad74fe27a5}{}\label{mouse_8c_a6ca7c8595f4c1116a2e057ad74fe27a5}


Definition at line 73 of file mouse.\+c.


\begin{DoxyCode}
74 \{
75   \textcolor{comment}{//asm volatile("cli");}
76   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} cycle = 0;
77   \textcolor{keyword}{static} \textcolor{keywordtype}{char} mouse\_bytes[3];
78   \textcolor{keywordflow}{while}(cycle<3)
79   mouse\_bytes[cycle++] = \hyperlink{sys_8h_a3d758e66f0e4acaf38ba39b58ce83e4d}{inb}(0x60);
80   \textcolor{keywordtype}{int} deltax=0,deltay=0;
81   \textcolor{keywordflow}{if} (cycle == 3) \{ \textcolor{comment}{// if we have all the 3 bytes...}
82     cycle = 0; \textcolor{comment}{// reset the counter}
83     \textcolor{comment}{// do what you wish with the bytes, this is just a sample}
84     \textcolor{keywordflow}{if} ((mouse\_bytes[0] & 0x80) || (mouse\_bytes[0] & 0x40))
85       \textcolor{keywordflow}{return}; \textcolor{comment}{// the mouse only sends information about overflowing, do not care about it and return}
86     \textcolor{keywordflow}{if} (!(mouse\_bytes[0] & 0x20))
87       deltay |= 0xFFFFFF00; \textcolor{comment}{//delta-y is a negative value}
88     \textcolor{keywordflow}{if} (!(mouse\_bytes[0] & 0x10))
89       deltax |= 0xFFFFFF00; \textcolor{comment}{//delta-x is a negative value}
90    \textcolor{comment}{// if (mouse\_bytes[0] & 0x4)}
91       \textcolor{comment}{//RectD(100,100,50,50,000,100,1000); //A Mouse button click}
92     \textcolor{comment}{//if (mouse\_bytes[0] & 0x2)}
93       \textcolor{comment}{//RectD(100,100,100,50,1000,1000,1000); //Another Mouse Button Click}
94    \textcolor{comment}{// if (mouse\_bytes[0] & 0x1)}
95       \textcolor{comment}{//RectD(100,100,50,100,1000,90,2000);  //Another Mouse Button Clicked}
96     \textcolor{comment}{/*if(mouse\_bytes[1]>=1||mouse\_bytes>=1)}
97 \textcolor{comment}{        RectD(10,10,50,50,1000,1000,90);*/}
98     deltax=mouse\_bytes[1]/2;
99     deltay=mouse\_bytes[2]/2;
100     \hyperlink{mouse_8c_aa3d2105adcc19a5aba525c805fc49ff2}{mousex}+=(deltax);
101     \hyperlink{mouse_8c_a6d4a0453f23b7c4df1a7be2972529a0b}{mousey}-=(deltay);
102     \textcolor{comment}{//asm volatile("sti");}
103    \textcolor{comment}{// WriteText(mouse\_bytes[0],100,200,1000,0);}
104   \}
105 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=228pt]{mouse_8c_a6ca7c8595f4c1116a2e057ad74fe27a5_cgraph}
\end{center}
\end{figure}


\index{mouse.\+c@{mouse.\+c}!mouse\+\_\+read@{mouse\+\_\+read}}
\index{mouse\+\_\+read@{mouse\+\_\+read}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mouse\+\_\+read()}{mouse_read()}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char mouse\+\_\+read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c}{}\label{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c}


Definition at line 44 of file mouse.\+c.


\begin{DoxyCode}
45  \{
46  \textcolor{comment}{//Get response from mouse}
47  \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(0);
48  \textcolor{keywordflow}{return} \hyperlink{sys_8h_a3d758e66f0e4acaf38ba39b58ce83e4d}{inb}(0x60);
49  \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c_cgraph}
\end{center}
\end{figure}


\index{mouse.\+c@{mouse.\+c}!mouse\+\_\+wait@{mouse\+\_\+wait}}
\index{mouse\+\_\+wait@{mouse\+\_\+wait}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mouse\+\_\+wait(unsigned char type)}{mouse_wait(unsigned char type)}}]{\setlength{\rightskip}{0pt plus 5cm}void mouse\+\_\+wait (
\begin{DoxyParamCaption}
\item[{unsigned char}]{type}
\end{DoxyParamCaption}
)}\hypertarget{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{}\label{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}


Definition at line 7 of file mouse.\+c.


\begin{DoxyCode}
8 \{
9   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \_time\_out=100000;
10   \textcolor{keywordflow}{if}(type==0)
11   \{
12     \textcolor{keywordflow}{while}(\_time\_out--) \textcolor{comment}{//Data}
13     \{
14       \textcolor{keywordflow}{if}((\hyperlink{sys_8h_a3d758e66f0e4acaf38ba39b58ce83e4d}{inb}(0x64) & 1)==1)
15       \{
16         \textcolor{keywordflow}{return};
17       \}
18     \}
19     \textcolor{keywordflow}{return};
20   \}
21   \textcolor{keywordflow}{else}
22   \{
23     \textcolor{keywordflow}{while}(\_time\_out--) \textcolor{comment}{//Signal}
24     \{
25       \textcolor{keywordflow}{if}((\hyperlink{sys_8h_a3d758e66f0e4acaf38ba39b58ce83e4d}{inb}(0x64) & 2)==0)
26       \{
27         \textcolor{keywordflow}{return};
28       \}
29     \}
30     \textcolor{keywordflow}{return};
31   \}
32 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25_cgraph}
\end{center}
\end{figure}


\index{mouse.\+c@{mouse.\+c}!mouse\+\_\+write@{mouse\+\_\+write}}
\index{mouse\+\_\+write@{mouse\+\_\+write}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mouse\+\_\+write(unsigned char a\+\_\+write)}{mouse_write(unsigned char a_write)}}]{\setlength{\rightskip}{0pt plus 5cm}void mouse\+\_\+write (
\begin{DoxyParamCaption}
\item[{unsigned char}]{a\+\_\+write}
\end{DoxyParamCaption}
)}\hypertarget{mouse_8c_ae4379d8fb20df85b51a1f087ff736307}{}\label{mouse_8c_ae4379d8fb20df85b51a1f087ff736307}


Definition at line 33 of file mouse.\+c.


\begin{DoxyCode}
34  \{
35  \textcolor{comment}{//Wait to be able to send a command}
36  \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
37  \textcolor{comment}{//Tell the mouse we are sending a command}
38  \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x64, 0xD4);
39  \textcolor{comment}{//Wait for the final part}
40  \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
41  \textcolor{comment}{//Finally write}
42  \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x60, a\_write);
43  \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{mouse_8c_ae4379d8fb20df85b51a1f087ff736307_cgraph}
\end{center}
\end{figure}


\index{mouse.\+c@{mouse.\+c}!mouseinit@{mouseinit}}
\index{mouseinit@{mouseinit}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mouseinit()}{mouseinit()}}]{\setlength{\rightskip}{0pt plus 5cm}void mouseinit (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mouse_8c_a2c765935a206229e0b5d7c53d85326f0}{}\label{mouse_8c_a2c765935a206229e0b5d7c53d85326f0}


Definition at line 51 of file mouse.\+c.


\begin{DoxyCode}
52 \{
53     \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
54     \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x64,0xA8);
55     \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
56     \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x64,0x20);
57     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} status\_byte;
58     \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(0);
59     status\_byte = (\hyperlink{sys_8h_a3d758e66f0e4acaf38ba39b58ce83e4d}{inb}(0x60) | 2);
60     \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
61     \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x64, 0x60);
62     \hyperlink{mouse_8c_a1ffd7d0515d7a43415f28d1ae71a4e25}{mouse\_wait}(1);
63     \hyperlink{sys_8h_a1fe613f83e149aa1a4ae0d5f5149ab34}{outb}(0x60, status\_byte);
64     \hyperlink{mouse_8c_ae4379d8fb20df85b51a1f087ff736307}{mouse\_write}(0xF6);
65     \hyperlink{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c}{mouse\_read}();
66     \hyperlink{mouse_8c_ae4379d8fb20df85b51a1f087ff736307}{mouse\_write}(0xF4);
67     \hyperlink{mouse_8c_a0436fbbe660d94e71fbd2675fed95a6c}{mouse\_read}();
68     \hyperlink{interrupts_8c_ad7e285600239a8df8341de1cc39548f1}{register\_interrupt\_handler}(\hyperlink{system_8h_a57276d1481230d81d2bba849f935ce5a}{IRQ12},&
      \hyperlink{mouse_8c_a6ca7c8595f4c1116a2e057ad74fe27a5}{mouse\_handler});
69 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8c_a2c765935a206229e0b5d7c53d85326f0_cgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{mouse.\+c@{mouse.\+c}!mousex@{mousex}}
\index{mousex@{mousex}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mousex}{mousex}}]{\setlength{\rightskip}{0pt plus 5cm}int mousex =100}\hypertarget{mouse_8c_aa3d2105adcc19a5aba525c805fc49ff2}{}\label{mouse_8c_aa3d2105adcc19a5aba525c805fc49ff2}


Definition at line 71 of file mouse.\+c.

\index{mouse.\+c@{mouse.\+c}!mousey@{mousey}}
\index{mousey@{mousey}!mouse.\+c@{mouse.\+c}}
\subsubsection[{\texorpdfstring{mousey}{mousey}}]{\setlength{\rightskip}{0pt plus 5cm}int mousey =100}\hypertarget{mouse_8c_a6d4a0453f23b7c4df1a7be2972529a0b}{}\label{mouse_8c_a6d4a0453f23b7c4df1a7be2972529a0b}


Definition at line 71 of file mouse.\+c.

