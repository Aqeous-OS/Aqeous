\hypertarget{vmem_8c}{}\section{Experimental Edition/\+Source/\+Mem\+Management/vmem.c File Reference}
\label{vmem_8c}\index{Experimental Edition/\+Source/\+Mem\+Management/vmem.\+c@{Experimental Edition/\+Source/\+Mem\+Management/vmem.\+c}}
{\ttfamily \#include \char`\"{}vmem.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stdint.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stdio.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}string.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}paging.\+h\char`\"{}}\\*
Include dependency graph for vmem.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{vmem_8c__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{vmem_8c__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \hyperlink{vmem_8c_ac2bc8a6ea9783c848eabff245617fe5d}{Block\+Finder} (uint32\+\_\+t \hyperlink{multiboot_8h_a48f994dfe1a5aea3bce6dc7d2be8efd5}{addr})
\item 
void \hyperlink{vmem_8c_af1b23449cc4dd41f72614ecc55ac9d7f}{Mapper} ()
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{vmem.\+c@{vmem.\+c}!Block\+Finder@{Block\+Finder}}
\index{Block\+Finder@{Block\+Finder}!vmem.\+c@{vmem.\+c}}
\subsubsection[{\texorpdfstring{Block\+Finder(uint32\+\_\+t addr)}{BlockFinder(uint32_t addr)}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Block\+Finder (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{addr}
\end{DoxyParamCaption}
)}\hypertarget{vmem_8c_ac2bc8a6ea9783c848eabff245617fe5d}{}\label{vmem_8c_ac2bc8a6ea9783c848eabff245617fe5d}


Definition at line 7 of file vmem.\+c.


\begin{DoxyCode}
8 \{
9     \hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t} *Block;
10     \hyperlink{multiboot_8h_a48f994dfe1a5aea3bce6dc7d2be8efd5}{addr}/=4096;
11     Block=(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}*)((uint32\_t)\hyperlink{vmem_8h_a23fb7e1107b26858b1e5e6451f2f4ad4}{Mblock} + \textcolor{keyword}{sizeof}(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t})*(
      \hyperlink{multiboot_8h_a48f994dfe1a5aea3bce6dc7d2be8efd5}{addr}));
12     Block++; \textcolor{comment}{//there was an offset in blocks from the start; first block is at Mblock+sizeof(MemMap\_t)}
13     \textcolor{keywordflow}{return} (uint32\_t)Block;
14 \}
\end{DoxyCode}
\index{vmem.\+c@{vmem.\+c}!Mapper@{Mapper}}
\index{Mapper@{Mapper}!vmem.\+c@{vmem.\+c}}
\subsubsection[{\texorpdfstring{Mapper()}{Mapper()}}]{\setlength{\rightskip}{0pt plus 5cm}void Mapper (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{vmem_8c_af1b23449cc4dd41f72614ecc55ac9d7f}{}\label{vmem_8c_af1b23449cc4dd41f72614ecc55ac9d7f}


Definition at line 16 of file vmem.\+c.


\begin{DoxyCode}
17 \{
18   \textcolor{comment}{//it can be that 14th mb to 16th be memory mapped ISA hardware. So better not to use it.}
19     \hyperlink{vmem_8h_a23fb7e1107b26858b1e5e6451f2f4ad4}{Mblock}=(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}*)(0x01000000); \textcolor{comment}{//start of the memory map linked list from 16th mb.}
20     \hyperlink{vmem_8h_a1d636d3797ab1b3ac96a3f86fb3f1ac1}{StartFrame}=(\hyperlink{vmem_8h_aeae537702c4c6622d46fbe31dad9904f}{FrameMap\_t}*)(0x1000);
21     \hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}* tempBlock2=\hyperlink{vmem_8h_a23fb7e1107b26858b1e5e6451f2f4ad4}{Mblock};
22     uint32\_t i=0;
23     \hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t} NullBlock;
24     \hyperlink{string_8h_ab70ae7ba054fd55023ccf5b7ceae875a}{memset}((\textcolor{keywordtype}{void}*)&NullBlock,0,\textcolor{keyword}{sizeof}(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}));
25     \textcolor{keywordflow}{for}(i=0;i<(\hyperlink{vmem_8h_ad7a3d22321c93b2af4c720e4978c882f}{maxmem}/4096);i++) \textcolor{comment}{//Make blocks!!!}
26     \{
27         \textcolor{keywordflow}{for}(uint32\_t j=0;j<1024;j++)
28         \{
29             tempBlock2++;
30             *tempBlock2=NullBlock;
31             \textcolor{comment}{//memset((void*)tempBlock2,0,sizeof(MemMap\_t));}
32             tempBlock2->addr=(j+(i*1024))*4096;
33             \textcolor{keywordflow}{if}(\hyperlink{vmem_8h_a652241438a84d50f059167c4eea7f1cc}{mmap\_info})
34               tempBlock2->used=\hyperlink{vmem_8h_a652241438a84d50f059167c4eea7f1cc}{mmap\_info}->\hyperlink{structmemory__region_a3591afc4df88a58fa5a91eab6ebe94cc}{type}-1;
35             \textcolor{keywordflow}{else} tempBlock2->used=1;
36             \textcolor{keywordflow}{if}(tempBlock2->used)
37             \{
38               tempBlock2->map[0]=0xFFFFFFFF;
39               tempBlock2->map[1]=0xFFFFFFFF;
40               tempBlock2->map[2]=0xFFFFFFFF;
41               tempBlock2->map[3]=0xFFFFFFFF;
42             \}
43             uint32\_t add=((j+(i*1024))*4096);
44             \textcolor{keywordflow}{if}(add>=(\hyperlink{vmem_8h_a652241438a84d50f059167c4eea7f1cc}{mmap\_info}->\hyperlink{structmemory__region_a090957a0a7f28700a605cf6f5e8f614a}{startHi}+\hyperlink{vmem_8h_a652241438a84d50f059167c4eea7f1cc}{mmap\_info}->
      \hyperlink{structmemory__region_a3d6aa91c428379cfc829556e48aee067}{sizeHi}))
45             \{
46                  ++\hyperlink{vmem_8h_a652241438a84d50f059167c4eea7f1cc}{mmap\_info};
47             \}
48         \}
49         \textcolor{comment}{//printf(" ");}
50     \}
51     \hyperlink{vmem_8h_abbb985bc8b0a939e358573e2cf546790}{lastBlock}=tempBlock2;
52     tempBlock2=(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}*)\hyperlink{vmem_8c_ac2bc8a6ea9783c848eabff245617fe5d}{BlockFinder}((uint32\_t)\hyperlink{vmem_8h_a23fb7e1107b26858b1e5e6451f2f4ad4}{Mblock});
53     \textcolor{keywordflow}{while}(tempBlock2->addr<=(uint32\_t)\hyperlink{vmem_8h_abbb985bc8b0a939e358573e2cf546790}{lastBlock})
54     \{
55         tempBlock2->used=1;
56         \hyperlink{vmem_8h_a9d2e0cd915585cca8ca31389bd367d94}{lastBlockAddr}=tempBlock2;
57         tempBlock2++;
58     \}
59     tempBlock2=\hyperlink{vmem_8h_a23fb7e1107b26858b1e5e6451f2f4ad4}{Mblock};
60     \hyperlink{vmem_8h_a9897a993c2d0f2fd0cde7faac9aab792}{Kblock}=(\hyperlink{vmem_8h_a820b5c7c8db63c3b056cf18f190157df}{MemMap\_t}*)(\hyperlink{vmem_8h_a9d2e0cd915585cca8ca31389bd367d94}{lastBlockAddr}+\textcolor{keyword}{sizeof}(\hyperlink{vmem_8h_addeaab56ff885e2ac8908eb3138cc3af}{mblock}));
61 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=233pt]{vmem_8c_af1b23449cc4dd41f72614ecc55ac9d7f_cgraph}
\end{center}
\end{figure}


